<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>使用 Hugo 搭建个人博客网站并自动部署至 GitHub Pages | m1dsolo's blog</title>
<meta name=keywords content="Hugo,PaperMod,GitHub Pages,GitHub Actions,云服务器,图床,访问量统计,部署,评论,busuanzi,giscus"><meta name=description content="1. 前言
Hugo 是一个用 Go 语言编写的静态网站生成器，
它可以将 Markdown 文件转换为 HTML 文件，支持主题和插件，
生成的网站可以直接部署到 GitHub Pages 、云服务器等。
本文将介绍如何使用 Hugo 搭建个人博客并使用 GitHub Actions 自动部署到 GitHub Pages 上。
实现的效果是，当我们将博客的 Markdown 文件推送到 GitHub 仓库时，
GitHub Actions 会自动构建 Hugo 网站，并将生成的 HTML 文件推送到 GitHub Pages 上，
这样我们就可以通过https://<username>.github.io访问我们的博客。
后面会大致介绍下如何将 Hugo 部署到云服务器上，没有特殊需求不建议折腾。
2. 安装 Hugo
具体安装方法可以参考 Hugo 官方文档 。
以我使用的 Arch Linux 为例，可以通过以下命令安装 Hugo ：
sudo pacman -S hugo
3. 创建 Hugo 网站
初学者可以参考 Hugo 官方教程 。
由于我使用的是 PaperMod 主题，
如果你也想使用这个主题，
可以参考 PaperMod 安装教程 。
以下我列出使用 git submodule 方法（推荐）创建 PaperMod 主题的 Hugo 网站的命令："><meta name=author content="m1dsolo"><link rel=canonical href=https://m1dsolo.github.io/posts/hugo-blog/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://m1dsolo.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://m1dsolo.github.io/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://m1dsolo.github.io/favicon.ico><link rel=apple-touch-icon href=https://m1dsolo.github.io/favicon.ico><link rel=mask-icon href=https://m1dsolo.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=https://m1dsolo.github.io/posts/hugo-blog/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async data-api=https://m1dsolo.xyz/api src=https://m1dsolo.xyz/js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-3G6QXPCTL9"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3G6QXPCTL9")}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"]]},loader:{load:["ui/safe"]}}</script><meta name=baidu-site-verification content="codeva-SY7YdHe2RN"><script async src="https://www.googletagmanager.com/gtag/js?id=G-3G6QXPCTL9"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3G6QXPCTL9")}</script><meta property="og:url" content="https://m1dsolo.github.io/posts/hugo-blog/"><meta property="og:site_name" content="m1dsolo's blog"><meta property="og:title" content="使用 Hugo 搭建个人博客网站并自动部署至 GitHub Pages "><meta property="og:description" content="1. 前言 Hugo 是一个用 Go 语言编写的静态网站生成器， 它可以将 Markdown 文件转换为 HTML 文件，支持主题和插件， 生成的网站可以直接部署到 GitHub Pages 、云服务器等。
本文将介绍如何使用 Hugo 搭建个人博客并使用 GitHub Actions 自动部署到 GitHub Pages 上。
实现的效果是，当我们将博客的 Markdown 文件推送到 GitHub 仓库时， GitHub Actions 会自动构建 Hugo 网站，并将生成的 HTML 文件推送到 GitHub Pages 上， 这样我们就可以通过https://<username>.github.io访问我们的博客。
后面会大致介绍下如何将 Hugo 部署到云服务器上，没有特殊需求不建议折腾。
2. 安装 Hugo 具体安装方法可以参考 Hugo 官方文档 。
以我使用的 Arch Linux 为例，可以通过以下命令安装 Hugo ：
sudo pacman -S hugo 3. 创建 Hugo 网站 初学者可以参考 Hugo 官方教程 。 由于我使用的是 PaperMod 主题， 如果你也想使用这个主题， 可以参考 PaperMod 安装教程 。
以下我列出使用 git submodule 方法（推荐）创建 PaperMod 主题的 Hugo 网站的命令："><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-12T00:00:00+00:00"><meta property="article:modified_time" content="2025-02-12T00:00:00+00:00"><meta property="article:tag" content="Hugo"><meta property="og:image" content="https://m1dsolo.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://m1dsolo.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="使用 Hugo 搭建个人博客网站并自动部署至 GitHub Pages "><meta name=twitter:description content="1. 前言
Hugo 是一个用 Go 语言编写的静态网站生成器，
它可以将 Markdown 文件转换为 HTML 文件，支持主题和插件，
生成的网站可以直接部署到 GitHub Pages 、云服务器等。
本文将介绍如何使用 Hugo 搭建个人博客并使用 GitHub Actions 自动部署到 GitHub Pages 上。
实现的效果是，当我们将博客的 Markdown 文件推送到 GitHub 仓库时，
GitHub Actions 会自动构建 Hugo 网站，并将生成的 HTML 文件推送到 GitHub Pages 上，
这样我们就可以通过https://<username>.github.io访问我们的博客。
后面会大致介绍下如何将 Hugo 部署到云服务器上，没有特殊需求不建议折腾。
2. 安装 Hugo
具体安装方法可以参考 Hugo 官方文档 。
以我使用的 Arch Linux 为例，可以通过以下命令安装 Hugo ：
sudo pacman -S hugo
3. 创建 Hugo 网站
初学者可以参考 Hugo 官方教程 。
由于我使用的是 PaperMod 主题，
如果你也想使用这个主题，
可以参考 PaperMod 安装教程 。
以下我列出使用 git submodule 方法（推荐）创建 PaperMod 主题的 Hugo 网站的命令："><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"文章","item":"https://m1dsolo.github.io/posts/"},{"@type":"ListItem","position":2,"name":"使用 Hugo 搭建个人博客网站并自动部署至 GitHub Pages ","item":"https://m1dsolo.github.io/posts/hugo-blog/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用 Hugo 搭建个人博客网站并自动部署至 GitHub Pages ","name":"使用 Hugo 搭建个人博客网站并自动部署至 GitHub Pages ","description":"1. 前言 Hugo 是一个用 Go 语言编写的静态网站生成器， 它可以将 Markdown 文件转换为 HTML 文件，支持主题和插件， 生成的网站可以直接部署到 GitHub Pages 、云服务器等。\n本文将介绍如何使用 Hugo 搭建个人博客并使用 GitHub Actions 自动部署到 GitHub Pages 上。\n实现的效果是，当我们将博客的 Markdown 文件推送到 GitHub 仓库时， GitHub Actions 会自动构建 Hugo 网站，并将生成的 HTML 文件推送到 GitHub Pages 上， 这样我们就可以通过https://\u0026lt;username\u0026gt;.github.io访问我们的博客。\n后面会大致介绍下如何将 Hugo 部署到云服务器上，没有特殊需求不建议折腾。\n2. 安装 Hugo 具体安装方法可以参考 Hugo 官方文档 。\n以我使用的 Arch Linux 为例，可以通过以下命令安装 Hugo ：\nsudo pacman -S hugo 3. 创建 Hugo 网站 初学者可以参考 Hugo 官方教程 。 由于我使用的是 PaperMod 主题， 如果你也想使用这个主题， 可以参考 PaperMod 安装教程 。\n以下我列出使用 git submodule 方法（推荐）创建 PaperMod 主题的 Hugo 网站的命令：\n","keywords":["Hugo","PaperMod","GitHub Pages","GitHub Actions","云服务器","图床","访问量统计","部署","评论","busuanzi","giscus"],"articleBody":"1. 前言 Hugo 是一个用 Go 语言编写的静态网站生成器， 它可以将 Markdown 文件转换为 HTML 文件，支持主题和插件， 生成的网站可以直接部署到 GitHub Pages 、云服务器等。\n本文将介绍如何使用 Hugo 搭建个人博客并使用 GitHub Actions 自动部署到 GitHub Pages 上。\n实现的效果是，当我们将博客的 Markdown 文件推送到 GitHub 仓库时， GitHub Actions 会自动构建 Hugo 网站，并将生成的 HTML 文件推送到 GitHub Pages 上， 这样我们就可以通过https://.github.io访问我们的博客。\n后面会大致介绍下如何将 Hugo 部署到云服务器上，没有特殊需求不建议折腾。\n2. 安装 Hugo 具体安装方法可以参考 Hugo 官方文档 。\n以我使用的 Arch Linux 为例，可以通过以下命令安装 Hugo ：\nsudo pacman -S hugo 3. 创建 Hugo 网站 初学者可以参考 Hugo 官方教程 。 由于我使用的是 PaperMod 主题， 如果你也想使用这个主题， 可以参考 PaperMod 安装教程 。\n以下我列出使用 git submodule 方法（推荐）创建 PaperMod 主题的 Hugo 网站的命令：\nhugo new site blog --format yaml # 可以替换 blog 为其他目录名 cd blog git submodule add --depth=1 https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod echo \"theme: [\\\"PaperMod\\\"]\" \u003e\u003e hugo.yaml 如果你未来想要更新 PaperMod 主题，可以使用以下命令：\ngit submodule update --remote --merge 4. 编写博客 可以参考 如何新建文章 ， 以及 如何组织目录结构 。\n新建文章 hugo new content content/posts/hello-world/index.md content/posts/hello-world/index.md就是新建的文章的路径， 你可以在这个文件中使用 Markdown 语法编辑你的博客内容。\n其中draft字段决定了文章是否为草稿， 如果你想要发布这篇文章，可以将draft字段设置为false。\n预览 Hugo 网站 当你完成了博客的编辑，可以使用以下命令在本地运行 Hugo 网站：\nhugo server -D # -D 参数表示需要显示草稿 你可以在浏览器中访问http://localhost:1313（终端中输出的地址）从而在本地浏览你的博客。\n网站具有实时预览效果，每当你修改了博客内容后，浏览器会自动刷新。\n配置 Hugo 网站（可选） 具体网站的配置可以参考 Hugo 官方文档 以及 PaperMod 文档 。 也可以参考我个人博客网站的 配置 。\n5. 使用 Github 管理博客 使用版本控制工具可以方便我们管理博客的历史版本，同时也算是一种备份。\n创建 GitHub 仓库 具体如何创建可以搜网上的教程，这里不再赘述。 创建并提交后的仓库类似于 github.com/m1dsolo/blog 。\n6. 部署到 GitHub Pages 到目前为止，我们已经完成了本地 Hugo 网站的搭建和博客的编写， 接下来我们将介绍如何使用 GitHub Actions 自动部署到 GitHub Pages 上。\nGitHub Actions 配置 首先对于我们刚刚创建好的 GitHub 仓库，我们需要配置 GitHub Actions ， 这样每当我们将博客的 Markdown 文件推送到 GitHub 仓库时， GitHub Actions 会自动构建 Hugo 网站，并将生成的 HTML 文件推送到 GitHub Pages 上。\n在博客仓库的根目录下创建.github/workflows目录， 然后在该目录下创建deploy.yml文件，填入：\nname: Deploy with Hugo on: push: branches: - main jobs: build-deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 with: fetch-depth: 0 - name: Setup Hugo uses: peaceiris/actions-hugo@v3 with: hugo-version: 'latest' extended: true - name: Build run: hugo --minify - name: Deploy Github uses: peaceiris/actions-gh-pages@v4 if: github.ref == 'refs/heads/main' with: personal_token: ${{ secrets.PERSONAL_TOKEN }} external_repository: m1dsolo/m1dsolo.github.io publish_branch: main publish_dir: ./public 创建 Personal Token 因为 GitHub Actions 需要推送生成的 HTML 文件到 GitHub Pages 上， 也就是需要访问另外一个仓库，通过配置 Personal Token 可以赋予当前仓库操控另外一个仓库的权限。 可以参考 peaceiris/actions-gh-pages 。\n如果之前没有创建过 Personal Token ，可以在 github tokens 页面创建一个 token ，\n配置 Secrets 在 GitHub 博客仓库的 Settings -\u003e Secrets 页面中，添加一个名为PERSONAL_TOKEN的 secret ， 值为你刚刚创建的 Personal Token 。（PERSONAL_TOKEN这个变量名与deploy.yml中变量名保持一致）。\n创建 GitHub Pages 仓库 创建 GitHub 仓库.github.io，其中为你的 GitHub 用户名。 这个仓库将用于存放 Hugo 的生成的 html 文件， github 会自动将这些文件部署到https://.github.io。 以我的 GitHub 为例，我的仓库为 m1dsolo.github.io 。\n7. 配置图床（可选） 博客中的图片可以使用图床来存储，这样可以减少 Git 仓库的大小。 可以选择一些免费图床，但是有些图床可能会有流量限制，同时可能会有访问速度的问题。 我这里选择使用自己的云服务器作为图床。\n大致步骤：\nupload_image脚本传输图片到云服务器 nginx配置图片访问路径 neovim插件来自动上传图片 具体就不细说了，以后有机会再展开。\n8. 配置搜索（可选） 参考 PaperMod 搜索文档 。\n9. 配置 favicon （可选） favicon 是网站的图标，比如：\n你可以使用 favicon.io 来生成 favicon 。\n只需要将生成的favicon.ico放到static目录下，然后修改hugo.yaml：`\nparams: assets: favicon: \"favicon.ico\" favicon16x16: \"favicon.ico\" favicon32x32: \"favicon.ico\" apple_touch_icon: \"favicon.ico\" safari_pinned_tab: \"favicon.ico\" 9. 配置评论（可选） 这里我选用 giscus 来配置评论功能。 因为它开源同时支持 GitHub 登录，不需要注册额外的账号。\n配置 giscus 链接为 giscus.app 。 具体配置步骤如下：\n在你的仓库.github.io中启用 Discussion （Settings -\u003e Features -\u003e Discussions）， 同时确保你的仓库是公开的。\n安装 giscus app ，赋予仓库.github.io权限。\n根据 giscus 的script修改hugo.yaml：\ngiscus 的 script 如下： 修改为对应的yaml格式写入hugo.yaml中：\nparams: giscus: repo: \"m1dsolo/m1dsolo.github.io\" repoId: \"R_kgDONmlNVQ\" category: \"Announcements\" categoryId: \"DIC_kwDONmlNVc4Cm94p\" mapping: \"pathname\" strict: 0 reactionsEnabled: 1 emitMetadata: 0 inputPosition: \"bottom\" theme: \"preferred_color_scheme\" lang: \"zh-CN\" crossorigin: \"anonymous\" 在layouts/partials下新建comments.html文件并填入：\n\u003cdiv id=\"tw-comment\"\u003e\u003c/div\u003e \u003cscript\u003e // 默认是暗色，根目录下的配置中的主题默认也是暗色 const getStoredTheme = () =\u003e localStorage.getItem(\"pref-theme\") === \"light\" ? \"{{ .Site.Params.giscus.lightTheme }}\" : \"{{ .Site.Params.giscus.darkTheme }}\"; const setGiscusTheme = () =\u003e { const sendMessage = (message) =\u003e { const iframe = document.querySelector('iframe.giscus-frame'); if (iframe) { iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app'); } } sendMessage({setConfig: {theme: getStoredTheme()}}) } document.addEventListener(\"DOMContentLoaded\", () =\u003e { const giscusAttributes = { \"src\": \"https://giscus.app/client.js\", \"data-repo\": \"{{ .Site.Params.giscus.repo }}\", \"data-repo-id\": \"{{ .Site.Params.giscus.repoId }}\", \"data-category\": \"{{ .Site.Params.giscus.category }}\", \"data-category-id\": \"{{ .Site.Params.giscus.categoryId }}\", \"data-mapping\": \"{{ .Site.Params.giscus.mapping }}\", \"data-strict\": \"{{ .Site.Params.giscus.strict }}\", \"data-reactions-enabled\": \"{{ .Site.Params.giscus.reactionsEnabled }}\", \"data-emit-metadata\": \"{{ .Site.Params.giscus.emitMetadata }}\", \"data-input-position\": \"{{ .Site.Params.giscus.inputPosition }}\", \"data-theme\": getStoredTheme(), \"data-lang\": \"{{ .Site.Params.giscus.lang }}\", \"data-loading\": \"lazy\", \"crossorigin\": \"anonymous\", }; // 动态创建 giscus script const giscusScript = document.createElement(\"script\"); Object.entries(giscusAttributes).forEach( ([key, value]) =\u003e giscusScript.setAttribute(key, value)); document.querySelector(\"#tw-comment\").appendChild(giscusScript); // 页面主题变更后，变更 giscus 主题 const themeSwitcher = document.querySelector(\"#theme-toggle\"); if (themeSwitcher) { themeSwitcher.addEventListener(\"click\", setGiscusTheme); } const themeFloatSwitcher = document.querySelector(\"#theme-toggle-float\"); if (themeFloatSwitcher) { themeFloatSwitcher.addEventListener(\"click\", setGiscusTheme); } }); \u003c/script\u003e 10. 配置数学公式（可选） 这里使用mathjax来配置数学公式。\n参考 官方文档 。\n在layouts/partials下新建mathjax.html文件并填入： \u003cscript id=\"MathJax-script\" async src=\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js\"\u003e\u003c/script\u003e \u003cscript\u003e MathJax = { tex: { displayMath: [['\\\\[', '\\\\]'], ['$$', '$$']], // block inlineMath: [['\\\\(', '\\\\)']] // inline }, loader:{ load: ['ui/safe'] }, }; \u003c/script\u003e 在layouts/partials下新建extend_head.html文件并填入： {{ if or .Params.math .Site.Params.math }} {{ partialCached \"math.html\" . }} {{ end }} 在hugo.yaml`中添加以下配置： markup: goldmark: extensions: passthrough: delimiters: block: - - \\[ - \\] - - $$ - $$ inline: - - \\( - \\) enable: true params: math: true 测试用数学公式：\n行内数学公式：\\(a^2 + b^2 = c^2\\)。 块公式： $$ a^2 + b^2 = c^2 $$ \\[ a^*=x-b^* \\] latex: \\[ \\begin{aligned} KL(\\hat{y} || y) \u0026= \\sum_{c=1}^{M}\\hat{y}_c \\log{\\frac{\\hat{y}_c}{y_c}} \\\\ JS(\\hat{y} || y) \u0026= \\frac{1}{2}(KL(y||\\frac{y+\\hat{y}}{2}) + KL(\\hat{y}||\\frac{y+\\hat{y}}{2})) \\end{aligned} \\] 行内数学公式：\\(a^2 + b^2 = c^2\\)。\n块公式：\n$$ a^2 + b^2 = c^2 $$\\[ a^*=x-b^* \\]latex:\n\\[ \\begin{aligned} KL(\\hat{y} || y) \u0026= \\sum_{c=1}^{M}\\hat{y}_c \\log{\\frac{\\hat{y}_c}{y_c}} \\\\ JS(\\hat{y} || y) \u0026= \\frac{1}{2}(KL(y||\\frac{y+\\hat{y}}{2}) + KL(\\hat{y}||\\frac{y+\\hat{y}}{2})) \\end{aligned} \\]mathjax渲染的数学公式结果如下（图片）：\n我遇到的问题主要是在某些网络环境下mathjax无法读取： 以后有需要再研究如何解决。\n11. Google Analytics （可选） Google Analytics 可以帮助我们分析网站的访问情况，可以参考 官方文档 。\n首先在 google analytics 中注册一个账号，然后获取tracking_id。\n将tracking_id添加到hugo.yaml中：\nservices: googleAnalytics: id: \"G-XXXXXXXXXX\" # replace with your tracking_id 在layouts/partials/extend_head.html中添加： {{ template \"_internal/google_analytics.html\" . }} 12. 访问量统计（可选） 我希望可以统计各个博客以及整个网站的访问量， 这里使用 busuanzi 来进行统计。 具体安装使用教程见 github 。\n13. 部署至云服务器（进阶） 由于国内访问 GitHub Pages 速度可能较慢，可以选择将个人博客网站部署到国内云服务器上。 我选择同时在云服务器上也部署博客网站主要是因为有一台云服务器闲置，不折腾下感觉浪费了。\n部署到云服务器上大致以下步骤：\n购买云服务器 购买域名 配置域名解析 配置 Nginx 域名备案 将备案信息添加到 footer secrets 配置云服务器的私钥 修改deploy.yml 大部分内容可以网上搜到，我具体展开介绍下将备案信息添加到 footer和修改 deploy.yml。\n将备案信息添加到 footer 在layouts/partials/extend_footer.html内新增：\n\u003cdiv style=\"display: flex; align-items: center; justify-content: center;\"\u003e \u003cimg src=\"/image/beian-logo.png\" width=\"12\" style=\"margin-right: 5px;\"/\u003e \u003ca href=\"https://beian.miit.gov.cn\" rel=\"noreferrer\" target=\"_blank\" style=\"font-size: 12px;\"\u003e京 ICP 备 2025109231 号-1\u003c/a\u003e \u003c/div\u003e 具体备案信息修改为自己的即可。\n修改deploy.yml 注意需要在hugo --minify时使用-b 参数来指代不同的baseURL， 因为 GitHub Pages 的域名是https://.github.io， 与个人网站的域名不同。\nname: Deploy with Hugo on: push: branches: - main jobs: build-deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 with: submodules: true fetch-depth: 1 - name: Setup Hugo uses: peaceiris/actions-hugo@v3 with: hugo-version: 'latest' extended: true - name: Build for Github run: hugo --minify -b https://m1dsolo.github.io/ - name: Deploy Github uses: peaceiris/actions-gh-pages@v4 if: github.ref == 'refs/heads/main' with: personal_token: ${{ secrets.PERSONAL_TOKEN }} external_repository: m1dsolo/m1dsolo.github.io publish_branch: main publish_dir: ./public - name: Build for Server run: hugo --minify -b http://m1dsolo.xyz/ - name: Deploy Server uses: wlixcc/SFTP-Deploy-Action@v1.2.5 if: github.ref == 'refs/heads/main' with: username: root server: ${{ secrets.SERVER_IP }} ssh_private_key: ${{ secrets.SSH_PRIVATE_KEY }} local_path: ./public/* remote_path: /var/www/blog sftpArgs: '-o ConnectTimeout=5' 注意将上面的-b参数改为你自己的域名。\n14. 结语 通过本文的步骤，我们成功地使用 Hugo 搭建了个人博客网站，并通过 GitHub Actions 实现了自动部署到 GitHub Pages 的功能。\n现在，每次你完成博客的撰写，只需将仓库推送到 GitHub ， 更新的内容就会自动部署到你的个人博客网站 https://.github.io 上。 （别忘了将博客内的 draft 字段改为 false）\n","wordCount":"955","inLanguage":"zh-cn","image":"https://m1dsolo.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-02-12T00:00:00Z","dateModified":"2025-02-12T00:00:00Z","author":{"@type":"Person","name":"m1dsolo"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://m1dsolo.github.io/posts/hugo-blog/"},"publisher":{"@type":"Organization","name":"m1dsolo's blog","logo":{"@type":"ImageObject","url":"https://m1dsolo.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://m1dsolo.github.io/ accesskey=h title="主页 (Alt + H)">主页</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://m1dsolo.github.io/posts/ title=文章><span>文章</span></a></li><li><a href=https://m1dsolo.github.io/tags/ title=标签><span>标签</span></a></li><li><a href=https://m1dsolo.github.io/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://m1dsolo.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://m1dsolo.github.io/posts/>文章</a></div><h1 class="post-title entry-hint-parent">使用 Hugo 搭建个人博客网站并自动部署至 GitHub Pages</h1><div class=post-meta><span title='2025-02-12 00:00:00 +0000 UTC'>2025-2-12</span>&nbsp;·&nbsp;955 words
·&nbsp<span id=busuanzi_page_pv></span>&nbsp阅读量
   </div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-前言>1. 前言</a></li><li><a href=#2-安装-hugo>2. 安装 Hugo</a></li><li><a href=#3-创建-hugo-网站>3. 创建 Hugo 网站</a></li><li><a href=#4-编写博客>4. 编写博客</a></li><li><a href=#5-使用-github-管理博客>5. 使用 Github 管理博客</a></li><li><a href=#6-部署到-github-pages>6. 部署到 GitHub Pages</a></li><li><a href=#7-配置图床可选>7. 配置图床（可选）</a></li><li><a href=#8-配置搜索可选>8. 配置搜索（可选）</a></li><li><a href=#9-配置-favicon-可选>9. 配置 favicon （可选）</a></li><li><a href=#9-配置评论可选>9. 配置评论（可选）</a></li><li><a href=#10-配置数学公式可选>10. 配置数学公式（可选）</a></li><li><a href=#11-google-analytics-可选>11. Google Analytics （可选）</a></li><li><a href=#12-访问量统计可选>12. 访问量统计（可选）</a></li><li><a href=#13-部署至云服务器进阶>13. 部署至云服务器（进阶）</a><ul><li><a href=#将备案信息添加到-footer>将备案信息添加到 footer</a></li><li><a href=#修改deployyml>修改<code>deploy.yml</code></a></li></ul></li><li><a href=#14-结语>14. 结语</a></li></ul></nav></div></details></div><div class=post-content><h2 id=1-前言>1. 前言<a hidden class=anchor aria-hidden=true href=#1-前言>#</a></h2><p><a href=https://github.com/gohugoio/hugo>Hugo</a> 是一个用 Go 语言编写的静态网站生成器，
它可以将 Markdown 文件转换为 HTML 文件，支持主题和插件，
生成的网站可以直接部署到 GitHub Pages 、云服务器等。</p><p>本文将介绍如何使用 Hugo 搭建个人博客并使用 GitHub Actions 自动部署到 GitHub Pages 上。</p><p>实现的效果是，当我们将博客的 Markdown 文件推送到 GitHub 仓库时，
GitHub Actions 会自动构建 Hugo 网站，并将生成的 HTML 文件推送到 GitHub Pages 上，
这样我们就可以通过<code>https://&lt;username>.github.io</code>访问我们的博客。</p><p>后面会大致介绍下如何将 Hugo 部署到云服务器上，没有特殊需求不建议折腾。</p><h2 id=2-安装-hugo>2. 安装 Hugo<a hidden class=anchor aria-hidden=true href=#2-安装-hugo>#</a></h2><p>具体安装方法可以参考 <a href=https://gohugo.io/getting-started/installing>Hugo 官方文档</a> 。</p><p>以我使用的 Arch Linux 为例，可以通过以下命令安装 Hugo ：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pacman -S hugo
</span></span></code></pre></div><h2 id=3-创建-hugo-网站>3. 创建 Hugo 网站<a hidden class=anchor aria-hidden=true href=#3-创建-hugo-网站>#</a></h2><p>初学者可以参考 <a href=https://gohugo.io/getting-started/quick-start>Hugo 官方教程</a> 。
由于我使用的是 <a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a> 主题，
如果你也想使用这个主题，
可以参考 <a href=https://github.com/adityatelange/hugo-PaperMod/wiki/Installation>PaperMod 安装教程</a> 。</p><p>以下我列出使用 git submodule 方法（推荐）创建 PaperMod 主题的 Hugo 网站的命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo new site blog --format yaml  <span class=c1># 可以替换 blog 为其他目录名</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> blog
</span></span><span class=line><span class=cl>git submodule add --depth<span class=o>=</span><span class=m>1</span> https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;theme: [\&#34;PaperMod\&#34;]&#34;</span> &gt;&gt; hugo.yaml
</span></span></code></pre></div><p>如果你未来想要更新 PaperMod 主题，可以使用以下命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git submodule update --remote --merge
</span></span></code></pre></div><h2 id=4-编写博客>4. 编写博客<a hidden class=anchor aria-hidden=true href=#4-编写博客>#</a></h2><p>可以参考 <a href=https://gohugo.io/getting-started/quick-start/#add-content>如何新建文章</a> ，
以及 <a href=https://gohugo.io/content-management/organization>如何组织目录结构</a> 。</p><ol><li>新建文章</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo new content content/posts/hello-world/index.md
</span></span></code></pre></div><p><code>content/posts/hello-world/index.md</code>就是新建的文章的路径，
你可以在这个文件中使用 Markdown 语法编辑你的博客内容。</p><p>其中<code>draft</code>字段决定了文章是否为草稿，
如果你想要发布这篇文章，可以将<code>draft</code>字段设置为<code>false</code>。</p><ol start=2><li>预览 Hugo 网站</li></ol><p>当你完成了博客的编辑，可以使用以下命令在本地运行 Hugo 网站：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo server -D  <span class=c1># -D 参数表示需要显示草稿</span>
</span></span></code></pre></div><p>你可以在浏览器中访问<code>http://localhost:1313</code>（终端中输出的地址）从而在本地浏览你的博客。</p><p>网站具有实时预览效果，每当你修改了博客内容后，浏览器会自动刷新。</p><ol start=3><li>配置 Hugo 网站（可选）</li></ol><p>具体网站的配置可以参考 <a href=https://gohugo.io/getting-started/configuration>Hugo 官方文档</a> 以及 <a href=https://github.com/adityatelange/hugo-PaperMod/wiki/Features>PaperMod 文档</a> 。
也可以参考我个人博客网站的 <a href=https://github.com/m1dsolo/blog>配置</a> 。</p><h2 id=5-使用-github-管理博客>5. 使用 Github 管理博客<a hidden class=anchor aria-hidden=true href=#5-使用-github-管理博客>#</a></h2><p>使用版本控制工具可以方便我们管理博客的历史版本，同时也算是一种备份。</p><ol><li>创建 GitHub 仓库</li></ol><p>具体如何创建可以搜网上的教程，这里不再赘述。
创建并提交后的仓库类似于 <a href=https://github.com/m1dsolo/blog>github.com/m1dsolo/blog</a> 。</p><h2 id=6-部署到-github-pages>6. 部署到 GitHub Pages<a hidden class=anchor aria-hidden=true href=#6-部署到-github-pages>#</a></h2><p>到目前为止，我们已经完成了本地 Hugo 网站的搭建和博客的编写，
接下来我们将介绍如何使用 GitHub Actions 自动部署到 GitHub Pages 上。</p><ol><li>GitHub Actions 配置</li></ol><p>首先对于我们刚刚创建好的 GitHub 仓库，我们需要配置 GitHub Actions ，
这样每当我们将博客的 Markdown 文件推送到 GitHub 仓库时，
GitHub Actions 会自动构建 Hugo 网站，并将生成的 HTML 文件推送到 GitHub Pages 上。</p><p>在博客仓库的根目录下创建<code>.github/workflows</code>目录，
然后在该目录下创建<code>deploy.yml</code>文件，填入：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy with Hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>build-deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>fetch-depth</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-hugo@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hugo-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;latest&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>extended</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>hugo --minify</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy Github</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-gh-pages@v4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>github.ref == &#39;refs/heads/main&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>personal_token</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.PERSONAL_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>external_repository</span><span class=p>:</span><span class=w> </span><span class=l>m1dsolo/m1dsolo.github.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>publish_branch</span><span class=p>:</span><span class=w> </span><span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>publish_dir</span><span class=p>:</span><span class=w> </span><span class=l>./public</span><span class=w>
</span></span></span></code></pre></div><ol start=2><li>创建 Personal Token</li></ol><p>因为 GitHub Actions 需要推送生成的 HTML 文件到 GitHub Pages 上，
也就是需要访问另外一个仓库，通过配置 Personal Token 可以赋予当前仓库操控另外一个仓库的权限。
可以参考 <a href="https://github.com/peaceiris/actions-gh-pages?tab=readme-ov-file#%EF%B8%8F-set-personal-access-token-personal_token">peaceiris/actions-gh-pages</a> 。</p><p>如果之前没有创建过 Personal Token ，可以在 <a href=https://github.com/settings/tokens>github tokens</a> 页面创建一个 token ，</p><ol start=3><li>配置 Secrets</li></ol><p>在 GitHub 博客仓库的 Settings -> Secrets 页面中，添加一个名为<code>PERSONAL_TOKEN</code>的 secret ，
值为你刚刚创建的 Personal Token 。（<code>PERSONAL_TOKEN</code>这个变量名与<code>deploy.yml</code>中变量名保持一致）。</p><ol start=4><li>创建 GitHub Pages 仓库</li></ol><p>创建 GitHub 仓库<code>&lt;username>.github.io</code>，其中<code>&lt;username></code>为你的 GitHub 用户名。
这个仓库将用于存放 Hugo 的生成的 html 文件，
github 会自动将这些文件部署到<code>https://&lt;username>.github.io</code>。
以我的 GitHub 为例，我的仓库为 <a href=https://github.com/m1dsolo/m1dsolo.github.io>m1dsolo.github.io</a> 。</p><h2 id=7-配置图床可选>7. 配置图床（可选）<a hidden class=anchor aria-hidden=true href=#7-配置图床可选>#</a></h2><p>博客中的图片可以使用图床来存储，这样可以减少 Git 仓库的大小。
可以选择一些免费图床，但是有些图床可能会有流量限制，同时可能会有访问速度的问题。
我这里选择使用自己的云服务器作为图床。</p><p>大致步骤：</p><ol><li><code>upload_image</code>脚本传输图片到云服务器</li><li><code>nginx</code>配置图片访问路径</li><li><code>neovim</code>插件来自动上传图片</li></ol><p>具体就不细说了，以后有机会再展开。</p><h2 id=8-配置搜索可选>8. 配置搜索（可选）<a hidden class=anchor aria-hidden=true href=#8-配置搜索可选>#</a></h2><p>参考 <a href=https://github.com/adityatelange/hugo-PaperMod/wiki/Features#search-page>PaperMod 搜索文档</a> 。</p><h2 id=9-配置-favicon-可选>9. 配置 favicon （可选）<a hidden class=anchor aria-hidden=true href=#9-配置-favicon-可选>#</a></h2><p>favicon 是网站的图标，比如：</p><p><img alt=favicon-show loading=lazy src=https://m1dsolo.xyz/images/hugo-blog/favicon-show.png></p><p>你可以使用 <a href=https://favicon.io/favicon-converter/>favicon.io</a> 来生成 favicon 。</p><p>只需要将生成的<code>favicon.ico</code>放到<code>static</code>目录下，然后修改<code>hugo.yaml</code>：`</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>params</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>assets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>favicon</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;favicon.ico&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>favicon16x16</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;favicon.ico&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>favicon32x32</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;favicon.ico&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apple_touch_icon</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;favicon.ico&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>safari_pinned_tab</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;favicon.ico&#34;</span><span class=w>
</span></span></span></code></pre></div><h2 id=9-配置评论可选>9. 配置评论（可选）<a hidden class=anchor aria-hidden=true href=#9-配置评论可选>#</a></h2><p>这里我选用 <a href=https://giscus.app/zh-CN>giscus</a> 来配置评论功能。
因为它开源同时支持 GitHub 登录，不需要注册额外的账号。</p><p>配置 giscus 链接为 <a href=https://giscus.app/zh-CN>giscus.app</a> 。
具体配置步骤如下：</p><ol><li><p>在你的仓库<code>&lt;username>.github.io</code>中启用 Discussion （<code>Settings</code> -> <code>Features</code> -> <code>Discussions</code>），
同时确保你的仓库是公开的。</p></li><li><p>安装 <a href=https://github.com/apps/giscus>giscus app</a> ，赋予仓库<code>&lt;username>.github.io</code>权限。</p></li><li><p>根据 giscus 的<code>script</code>修改<code>hugo.yaml</code>：</p></li></ol><p>giscus 的 script 如下：
<img alt=giscus-script loading=lazy src=https://m1dsolo.xyz/images/hugo-blog/giscus-script.png></p><p>修改为对应的<code>yaml</code>格式写入<code>hugo.yaml</code>中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>params</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>giscus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;m1dsolo/m1dsolo.github.io&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>repoId</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;R_kgDONmlNVQ&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>category</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Announcements&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>categoryId</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;DIC_kwDONmlNVc4Cm94p&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>mapping</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;pathname&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>strict</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>reactionsEnabled</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>emitMetadata</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>inputPosition</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;bottom&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>theme</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;preferred_color_scheme&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>lang</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;zh-CN&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>crossorigin</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;anonymous&#34;</span><span class=w>
</span></span></span></code></pre></div><p>在<code>layouts/partials</code>下新建<code>comments.html</code>文件并填入：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;tw-comment&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 默认是暗色，根目录下的配置中的主题默认也是暗色
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>getStoredTheme</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s2>&#34;pref-theme&#34;</span><span class=p>)</span> <span class=o>===</span> <span class=s2>&#34;light&#34;</span> <span class=o>?</span> <span class=s2>&#34;{{ .Site.Params.giscus.lightTheme }}&#34;</span> <span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.darkTheme }}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>setGiscusTheme</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>sendMessage</span> <span class=o>=</span> <span class=p>(</span><span class=nx>message</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>iframe</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;iframe.giscus-frame&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>iframe</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>iframe</span><span class=p>.</span><span class=nx>contentWindow</span><span class=p>.</span><span class=nx>postMessage</span><span class=p>({</span><span class=nx>giscus</span><span class=o>:</span> <span class=nx>message</span><span class=p>},</span> <span class=s1>&#39;https://giscus.app&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>sendMessage</span><span class=p>({</span><span class=nx>setConfig</span><span class=o>:</span> <span class=p>{</span><span class=nx>theme</span><span class=o>:</span> <span class=nx>getStoredTheme</span><span class=p>()}})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;DOMContentLoaded&#34;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>giscusAttributes</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;src&#34;</span><span class=o>:</span> <span class=s2>&#34;https://giscus.app/client.js&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-repo&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.repo }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-repo-id&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.repoId }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-category&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.category }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-category-id&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.categoryId }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-mapping&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.mapping }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-strict&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.strict }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-reactions-enabled&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.reactionsEnabled }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-emit-metadata&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.emitMetadata }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-input-position&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.inputPosition }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-theme&#34;</span><span class=o>:</span> <span class=nx>getStoredTheme</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-lang&#34;</span><span class=o>:</span> <span class=s2>&#34;{{ .Site.Params.giscus.lang }}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data-loading&#34;</span><span class=o>:</span> <span class=s2>&#34;lazy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;crossorigin&#34;</span><span class=o>:</span> <span class=s2>&#34;anonymous&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 动态创建 giscus script
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>giscusScript</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;script&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nb>Object</span><span class=p>.</span><span class=nx>entries</span><span class=p>(</span><span class=nx>giscusAttributes</span><span class=p>).</span><span class=nx>forEach</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=p>([</span><span class=nx>key</span><span class=p>,</span> <span class=nx>value</span><span class=p>])</span> <span class=p>=&gt;</span> <span class=nx>giscusScript</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=nx>value</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;#tw-comment&#34;</span><span class=p>).</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>giscusScript</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 页面主题变更后，变更 giscus 主题
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>themeSwitcher</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;#theme-toggle&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>themeSwitcher</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>themeSwitcher</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=nx>setGiscusTheme</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>themeFloatSwitcher</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;#theme-toggle-float&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>themeFloatSwitcher</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>themeFloatSwitcher</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=nx>setGiscusTheme</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h2 id=10-配置数学公式可选>10. 配置数学公式（可选）<a hidden class=anchor aria-hidden=true href=#10-配置数学公式可选>#</a></h2><p>这里使用<code>mathjax</code>来配置数学公式。</p><p>参考 <a href=https://gohugo.io/content-management/mathematics/#setup>官方文档</a> 。</p><ol><li>在<code>layouts/partials</code>下新建<code>mathjax.html</code>文件并填入：</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;MathJax-script&#34;</span> <span class=na>async</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>MathJax</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>tex</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>displayMath</span><span class=o>:</span> <span class=p>[[</span><span class=s1>&#39;\\[&#39;</span><span class=p>,</span> <span class=s1>&#39;\\]&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;$$&#39;</span><span class=p>,</span> <span class=s1>&#39;$$&#39;</span><span class=p>]],</span>  <span class=c1>// block
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>inlineMath</span><span class=o>:</span> <span class=p>[[</span><span class=s1>&#39;\\(&#39;</span><span class=p>,</span> <span class=s1>&#39;\\)&#39;</span><span class=p>]]</span>                  <span class=c1>// inline
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>loader</span><span class=o>:</span><span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>load</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;ui/safe&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><ol start=2><li>在<code>layouts/partials</code>下新建<code>extend_head.html</code>文件并填入：</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{{ if or .Params.math .Site.Params.math }}
</span></span><span class=line><span class=cl>    {{ partialCached &#34;math.html&#34; . }}
</span></span><span class=line><span class=cl>{{ end }}
</span></span></code></pre></div><ol start=3><li>在<code>hugo.</code>yaml`中添加以下配置：</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>markup</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>goldmark</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>passthrough</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>delimiters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>block</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- - <span class=l>\[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>\]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- - <span class=l>$$</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>$$</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>inline</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- - <span class=l>\(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>\)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enable</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>params</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>math</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div><p>测试用数学公式：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>行内数学公式：\(a^2 + b^2 = c^2\)。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>块公式：
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$$
</span></span><span class=line><span class=cl>a^2 + b^2 = c^2
</span></span><span class=line><span class=cl>$$
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>\[
</span></span><span class=line><span class=cl>a^*=x-b^*
</span></span><span class=line><span class=cl>\]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>latex:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>\[
</span></span><span class=line><span class=cl>\begin{aligned}
</span></span><span class=line><span class=cl>KL(\hat{y} || y) <span class=err>&amp;</span>= \sum_{c=1}^{M}\hat{y}_c \log{\frac{\hat{y}_c}{y_c}} \\
</span></span><span class=line><span class=cl>JS(\hat{y} || y) <span class=err>&amp;</span>= \frac{1}{2}(KL(y||\frac{y+\hat{y}}{2}) + KL(\hat{y}||\frac{y+\hat{y}}{2}))
</span></span><span class=line><span class=cl>\end{aligned}
</span></span><span class=line><span class=cl>\]
</span></span></code></pre></div><p>行内数学公式：\(a^2 + b^2 = c^2\)。</p><p>块公式：</p>$$
a^2 + b^2 = c^2
$$\[
a^*=x-b^*
\]<p>latex:</p>\[
\begin{aligned}
KL(\hat{y} || y) &= \sum_{c=1}^{M}\hat{y}_c \log{\frac{\hat{y}_c}{y_c}} \\
JS(\hat{y} || y) &= \frac{1}{2}(KL(y||\frac{y+\hat{y}}{2}) + KL(\hat{y}||\frac{y+\hat{y}}{2}))
\end{aligned}
\]<p><code>mathjax</code>渲染的数学公式结果如下（图片）：</p><p><img alt=mathjax-test loading=lazy src=https://m1dsolo.xyz/images/hugo-blog/mathjax-test.png></p><p>我遇到的问题主要是在某些网络环境下<code>mathjax</code>无法读取：
<img alt=mathjax-connection-error loading=lazy src=https://m1dsolo.xyz/images/hugo-blog/mathjax-connection-error.png></p><p>以后有需要再研究如何解决。</p><h2 id=11-google-analytics-可选>11. Google Analytics （可选）<a hidden class=anchor aria-hidden=true href=#11-google-analytics-可选>#</a></h2><p>Google Analytics 可以帮助我们分析网站的访问情况，可以参考 <a href=https://gohugo.io/templates/embedded/#google-analytics>官方文档</a> 。</p><ol><li><p>首先在 <a href=https://marketingplatform.google.com/about/analytics/>google analytics</a> 中注册一个账号，然后获取<code>tracking_id</code>。</p></li><li><p>将<code>tracking_id</code>添加到<code>hugo.yaml</code>中：</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>googleAnalytics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;G-XXXXXXXXXX&#34;</span><span class=w>  </span><span class=c># replace with your tracking_id</span><span class=w>
</span></span></span></code></pre></div><ol start=3><li>在<code>layouts/partials/extend_head.html</code>中添加：</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{{ template &#34;_internal/google_analytics.html&#34; . }}
</span></span></code></pre></div><h2 id=12-访问量统计可选>12. 访问量统计（可选）<a hidden class=anchor aria-hidden=true href=#12-访问量统计可选>#</a></h2><p>我希望可以统计各个博客以及整个网站的访问量，
这里使用 <a href=https://github.com/soxft/busuanzi>busuanzi</a> 来进行统计。
具体安装使用教程见 <a href=https://github.com/soxft/busuanzi>github</a> 。</p><h2 id=13-部署至云服务器进阶>13. 部署至云服务器（进阶）<a hidden class=anchor aria-hidden=true href=#13-部署至云服务器进阶>#</a></h2><p>由于国内访问 GitHub Pages 速度可能较慢，可以选择将个人博客网站部署到国内云服务器上。
我选择同时在云服务器上也部署博客网站主要是因为有一台云服务器闲置，不折腾下感觉浪费了。</p><p>部署到云服务器上大致以下步骤：</p><ol><li>购买云服务器</li><li>购买域名</li><li>配置域名解析</li><li>配置 Nginx</li><li>域名备案</li><li>将备案信息添加到 footer</li><li>secrets 配置云服务器的私钥</li><li>修改<code>deploy.yml</code></li></ol><p>大部分内容可以网上搜到，我具体展开介绍下<code>将备案信息添加到 footer</code>和<code>修改 deploy.yml</code>。</p><h3 id=将备案信息添加到-footer>将备案信息添加到 footer<a hidden class=anchor aria-hidden=true href=#将备案信息添加到-footer>#</a></h3><p>在<code>layouts/partials/extend_footer.html</code>内新增：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;display: flex; align-items: center; justify-content: center;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/image/beian-logo.png&#34;</span> <span class=na>width</span><span class=o>=</span><span class=s>&#34;12&#34;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;margin-right: 5px;&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://beian.miit.gov.cn&#34;</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;noreferrer&#34;</span> <span class=na>target</span><span class=o>=</span><span class=s>&#34;_blank&#34;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;font-size: 12px;&#34;</span><span class=p>&gt;</span>京 ICP 备 2025109231 号-1<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>具体备案信息修改为自己的即可。</p><h3 id=修改deployyml>修改<code>deploy.yml</code><a hidden class=anchor aria-hidden=true href=#修改deployyml>#</a></h3><p>注意需要在<code>hugo --minify</code>时使用<code>-b</code> 参数来指代不同的<code>baseURL</code>，
因为 GitHub Pages 的域名是<code>https://&lt;username>.github.io</code>，
与个人网站的域名不同。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy with Hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>build-deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>submodules</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>fetch-depth</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-hugo@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hugo-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;latest&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>extended</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build for Github</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>hugo --minify -b https://m1dsolo.github.io/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy Github</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-gh-pages@v4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>github.ref == &#39;refs/heads/main&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>personal_token</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.PERSONAL_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>external_repository</span><span class=p>:</span><span class=w> </span><span class=l>m1dsolo/m1dsolo.github.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>publish_branch</span><span class=p>:</span><span class=w> </span><span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>publish_dir</span><span class=p>:</span><span class=w> </span><span class=l>./public</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build for Server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>hugo --minify -b http://m1dsolo.xyz/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy Server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>wlixcc/SFTP-Deploy-Action@v1.2.5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>github.ref == &#39;refs/heads/main&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.SERVER_IP }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ssh_private_key</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.SSH_PRIVATE_KEY }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>local_path</span><span class=p>:</span><span class=w> </span><span class=l>./public/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>remote_path</span><span class=p>:</span><span class=w> </span><span class=l>/var/www/blog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>sftpArgs</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;-o ConnectTimeout=5&#39;</span><span class=w>
</span></span></span></code></pre></div><p>注意将上面的<code>-b</code>参数改为你自己的域名。</p><h2 id=14-结语>14. 结语<a hidden class=anchor aria-hidden=true href=#14-结语>#</a></h2><p>通过本文的步骤，我们成功地使用 Hugo 搭建了个人博客网站，并通过 GitHub Actions 实现了自动部署到 GitHub Pages 的功能。</p><p>现在，每次你完成博客的撰写，只需将仓库推送到 GitHub ，
更新的内容就会自动部署到你的个人博客网站 <code>https://&lt;username>.github.io</code> 上。
（别忘了将博客内的 <code>draft</code> 字段改为 <code>false</code>）</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://m1dsolo.github.io/tags/hugo/>Hugo</a></li></ul><nav class=paginav><a class=prev href=https://m1dsolo.github.io/posts/dwm-noswallow/><span class=title>«</span><br><span>在 DWM 中防止特定窗口被 swallow 的方法</span></a></nav></footer><div id=tw-comment></div><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="light"?"":"",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"m1dsolo/m1dsolo.github.io","data-repo-id":"R_kgDONmlNVQ","data-category":"Announcements","data-category-id":"DIC_kwDONmlNVc4Cm94p","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"zh-CN","data-loading":"lazy",crossorigin:"anonymous"},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#tw-comment").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><div style=display:flex;align-items:center;justify-content:center><img src=/image/beian-logo.png width=12 style=margin-right:5px>
<a href=https://beian.miit.gov.cn rel=noreferrer target=_blank style=font-size:12px>京ICP备2025109231号-1</a></div><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>